<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ortiz Facility Checker</title>
    <!-- Leaflet.js CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <!-- PapaParse.js for CSV parsing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <style>
        body {
            width: 99.9%;
            font-family: 'Orbitron', sans-serif;
            background-color: #0a0f1e;
            color: #e0e6f0;
            margin: 0;
            padding: 0;
        }

        .input-label {
            margin-left: 10px;
            /* adjust px as needed */
            display: inline-block;
            /* so margin works properly */
        }

        #map {
            width: 100%;
            height: 500px;
            position: relative;
        }

        /* ADVANDE DESINED WATER MARK */
        #watermark {
            position: fixed;
            bottom: 10px;
            right: 10px;
            font-size: 14px;
            color: #00f7ff;
            /* neon blue */
            background: rgba(20, 30, 60, 0.85);
            padding: 6px 14px;
            border-radius: 10px;
            border: 1px solid rgba(0, 247, 255, 0.6);
            font-family: "Orbitron",
                sans-serif;
            letter-spacing: 1px;
            box-shadow: 0 0 15px rgba(0, 247, 255, 0.4);
            text-shadow: 0 0 6px rgba(0, 247, 255, 0.9),
                0 0 12px rgba(0, 247, 255, 0.6);
            z-index: 1500;
            animation: watermarkGlow 3s infinite alternate;
        }


        /* glowing animation */
        @keyframes watermarkGlow {
            from {
                text-shadow: 0 0 6px rgba(0, 247, 255, 0.6), 0 0 12px rgba(0, 247, 255, 0.3);
                box-shadow: 0 0 10px rgba(0, 247, 255, 0.2);
            }

            to {
                text-shadow: 0 0 12px rgba(0, 247, 255, 1), 0 0 20px rgba(0, 247, 255, 0.7);
                box-shadow: 0 0 20px rgba(0, 247, 255, 0.6);
            }
        }

   /*  Futuristic MessageBox */
        .message-box {

            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(20, 30, 60, 0.95);
            color: #e0f7ff;
            border: 2px solid #00f7ff;
            padding: 20px 30px;
            border-radius: 12px;
            box-shadow: 0 0 25px #00f7ff, 0 0 50px rgba(0, 247, 255, 0.5);
            text-align: center;
            z-index: 10000;
            animation: fadeIn 0.3s ease-in-out;
        }

        .message-box button {
            margin-top: 15px;
            padding: 8px 18px;
            background: #00f7ff;
            border: none;
            color: #0a0f1e;
            font-weight: bold;
            border-radius: 6px;
            cursor: pointer;
            box-shadow: 0 0 10px #00f7ff;
            transition: all 0.2s ease-in-out;
        }

        .message-box button:hover {
            background: #00cce7;
            box-shadow: 0 0 15px #00eaff;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translate(-50%, -48%);
            }

            to {
                opacity: 1;
                transform: translate(-50%, -50%);
            }
        }

        /* Legend positioned at right */


        .legend {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(20, 30, 60, 0.9);
            padding: 15px;
            border: 2px solid #00f7ff;
            border-radius: 8px;
            font-size: 11px;
            color: #e0f7ff;
            box-shadow: 0 0 20px rgba(0, 247, 255, 0.3);
            z-index: 1000;
            /* ✅ keep it above map tiles */
        }

        .legend div {
            margin: 6px 0;
        }


        .input-container {
            margin: 20px 0;
        }

        label,
        input {
            margin-right: 10px;
        }

        input[type="text"] {
            width: 350px;
            height: 20px;
        }

        button {
            padding: 5px 10px;
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            background: #1976d2;
            color: #fff;
        }

        button.secondary {
            background: #4CAF50;
        }

        button:disabled {
            background-color: #3a4e5f;
            cursor: not-allowed;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            table-layout: fixed;
        }

        th,
        td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: left;
            overflow-x: auto;
            overflow-y: hidden;
            white-space: nowrap;
            max-width: 150px;
        }


        td::-webkit-scrollbar {
            height: 6px;
        }

        td::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 3px;
        }

        td::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        #resultcnt {
            display: inline-block;
            font-size: 14px;
            color: rgb(79, 187, 236);
            margin-top: 10px;

        }

        /* --------------------- REPORT TABLE ------------------------ */
        #reportdate {
            position: absolute;
            top: 10px;
            Left: 10px;
            font-size: 14px;
            color: #00f7ff;
            /* neon cyan text */
            background: rgba(20, 30, 60, 0.85);
            /* dark sci-fi panel */
            padding: 6px 14px;
            border-radius: 8px;
            font-family: "Orbitron", sans-serif;
            letter-spacing: 1px;
            border: 1px solid rgba(0, 247, 255, 0.6);
            border-bottom: 3px solid transparent;
            border-image: linear-gradient(to right, #ff004c, #007bff);
            border-image-slice: 1;
            text-shadow: 0 0 6px rgba(0, 247, 255, 0.9), 0 0 12px rgba(0, 247, 255, 0.6);
            box-shadow: 0 0 12px rgba(0, 247, 255, 0.3);
            z-index: 2000;
            animation: flicker 2.5s infinite alternate;
        }

        /* subtle flicker/glow */
        @keyframes flicker {
            from {
                opacity: 0.85;
                text-shadow: 0 0 6px rgba(0, 247, 255, 0.6), 0 0 12px rgba(0, 247, 255, 0.3);
                box-shadow: 0 0 10px rgba(0, 247, 255, 0.2);
            }

            to {
                opacity: 1;
                text-shadow: 0 0 12px rgba(0, 247, 255, 1), 0 0 20px rgba(0, 247, 255, 0.8);
                box-shadow: 0 0 18px rgba(0, 247, 255, 0.5);
            }
        }

        /* LOADING */

        #loading {
            display: none;
            /* hidden by default */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.8);
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .spinner {
            border: 6px solid #ddd;
            /* light gray */
            border-top: 6px solid #333;
            /* dark section */
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin-bottom: 10px;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .text {
            font-family: sans-serif;
            color: #333;
        }


        /* Instrunctions */
        #instructionsBtn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(20, 30, 60, 0.9);
            color: #00f7ff;
            border: 1px solid rgba(0, 247, 255, 0.6);
            border-radius: 50%;
            width: 36px;
            height: 36px;
            font-size: 18px;
            font-family: "Orbitron", sans-serif;
            box-shadow: 0 0 10px rgba(0, 247, 255, 0.6);
            cursor: pointer;
            z-index: 2000;
            transition: 0.3s;
        }

        #instructionsBtn:hover {
            background: rgba(0, 247, 255, 0.2);
            color: #fff;
            transform: scale(1.1);
        }

        /* Instructions Modal */
        #instructionsBox {
            display: none;
            /* hidden by default */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            z-index: 3000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .instructions-content {
            background: rgba(20, 30, 60, 0.95);
            padding: 20px 30px;
            border-radius: 15px;
            border: 1px solid rgba(0, 247, 255, 0.6);
            box-shadow: 0 0 25px rgba(0, 247, 255, 0.7);
            color: #00f7ff;
            font-family: "Orbitron", sans-serif;
            width: 400px;
            max-width: 80%;
            text-align: left;
        }

        .instructions-content h2 {
            margin-bottom: 15px;
            text-align: center;
        }

        .instructions-content ul {
            margin-left: 20px;
            margin-bottom: 20px;
        }

        .instructions-content button {
            display: block;
            margin: 0 auto;
            padding: 6px 16px;
            border-radius: 8px;
            background: #00f7ff;
            color: #141e3c;
            font-family: "Orbitron", sans-serif;
            cursor: pointer;
            border: none;
            transition: 0.3s;
        }

        .instructions-content button:hover {
            background: #00c6d4;
        }
    </style>
</head>

<body>
    <div id="reportdate"><strong>DRM:</strong> August 15, 2025
    </div>
    <div style="height: 20px; text-align: center; margin-top: 10px;">
        <H2>FACILITY CHECKER </H2>
    </div>
    <div class="input-container">
        <label for="locationInput" class="input-label">Input Location</label>
        <input type="text" id="locationInput" placeholder="Enter address or latitude, longitude">
        <button id="showLocationBtn" onclick="processInput()" disabled>Search</button>
        <button id="downloadCSV" onclick="exportTableToCSV('nearest_facility.csv')" style="display: none;">Download
            CSV</button>
        <span style="float: right;" id="resultcnt"></span>
    </div>
    <div id="loading">
        <div class="spinner"></div>
        <div class="text">Maghintay Ka Ha! - Loading Pa!.</div>
    </div>
    <div id="map">
        <div class="legend">
            <h4>Legend: <strong style="color: #cf26f1; font-size: 11px;"> %Util </strong></h4>
            <div style="display: flex; flex-direction: column; gap: 4px; font-size: 14px;">
                <div style="font-size: 10px;"><span
                        style="display: inline-block; width: 14px; height: 14px; background-color: blue; margin-right: 8px; border-radius: 50%;"></span>
                    Search</div>
                <div style="font-size: 10px;"><span
                        style="display: inline-block; width: 14px; height: 14px; background-color: green; margin-right: 8px; border-radius: 50%;"></span>
                    ≤ 25%</div>
                <div style="font-size: 10px;"><span
                        style="display: inline-block; width: 14px; height: 14px; background-color: yellow; margin-right: 8px; border-radius: 50%;"></span>
                    ≤ 50%</div>
                <div style="font-size: 10px;"><span
                        style="display: inline-block; width: 14px; height: 14px; background-color: orange; margin-right: 8px; border-radius: 50%;"></span>
                    ≤ 70%</div>
                <div style="font-size: 10px;"><span
                        style="display: inline-block; width: 14px; height: 14px; background-color: red; margin-right: 8px; border-radius: 50%;"></span>
                    > 70%</div>
            </div>
        </div>
    </div>
    <br>
    <!-- Table to display results -->
    <table id="resultTable" style="display:none;">
        <thead>
            <tr>
                <th>DP/Nap</th>
                <th>Cabinet</th>
                <th>Latitude</th>
                <th>Longitude</th>
                <th>Distance (Km)</th>
                <th>SellableLines</th>
                <th>Utilization</th>
                <th>Cab Type</th>
                <th>Address</th>
                <th>Bldg Name</th>
                <!--  <th>Technology</th> -->
                <th>Bandwidth</th>

            </tr>
        </thead>
        <tbody></tbody>
    </table>
    <!-- === Instructions Button === -->
    <button id="instructionsBtn">?</button>

    <!-- === Instructions Modal === -->
    <div id="instructionsBox" style="display: none;">
        <div class="instructions-content">
            <h2>📖 Facility Checker Instructions</h2>
            <ul>
                <li>Enter the facility coordinates (latitude, longitude) in the input field.</li>
                <li>Choose the type of cabinet (Indoor / Outdoor).</li>
                <li>Set your desired utilization threshold (%).</li>
                <li>Click <b>Search</b> to check available nearby facilities.</li>
                <li>Results will be shown on the map with color-coded utilization.</li>
            </ul>
            <button onclick="closeInstructions()">Close</button>
        </div>
    </div>

    <!-- Futuristic MessageBox -->
    <div id="messageBox" style="display: none;">
        <h2>Message</h2>
        <p id="messageContent"></p>
        <button onclick="closeMessageBox()">OK</button>
    </div>

    <div id="watermark">Created By: <strong>Sonny Ortiz</strong> </div>
    <!-- Leaflet.js and your custom JS -->
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script>
        var _0x3602a4 = _0x5b80; function _0x5b80(_0x5627ff, _0x16d1dd) { var _0x351ed4 = _0x351e(); return _0x5b80 = function (_0x5b807c, _0x20a951) { _0x5b807c = _0x5b807c - 0x140; var _0x4d7b48 = _0x351ed4[_0x5b807c]; return _0x4d7b48; }, _0x5b80(_0x5627ff, _0x16d1dd); } (function (_0x229211, _0x4226b5) { var _0x570de8 = _0x5b80, _0x96505a = _0x229211(); while (!![]) { try { var _0x1d01be = parseInt(_0x570de8(0x177)) / 0x1 + -parseInt(_0x570de8(0x143)) / 0x2 + -parseInt(_0x570de8(0x14c)) / 0x3 * (-parseInt(_0x570de8(0x15f)) / 0x4) + parseInt(_0x570de8(0x170)) / 0x5 * (parseInt(_0x570de8(0x160)) / 0x6) + parseInt(_0x570de8(0x16c)) / 0x7 * (parseInt(_0x570de8(0x191)) / 0x8) + -parseInt(_0x570de8(0x165)) / 0x9 + -parseInt(_0x570de8(0x185)) / 0xa; if (_0x1d01be === _0x4226b5) break; else _0x96505a['push'](_0x96505a['shift']()); } catch (_0x2df8f7) { _0x96505a['push'](_0x96505a['shift']()); } } }(_0x351e, 0xdf47d)); var map = L[_0x3602a4(0x16a)]('map')[_0x3602a4(0x17f)]([51.505, -0.09], 0x10); L[_0x3602a4(0x147)]('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { 'attribution': '&copy;\x20<a\x20href=\x22https://www.openstreetmap.org/copyright\x22>OpenStreetMap</a>\x20contributors' })['addTo'](map); var allLocations = [], markers = [], csvURL = _0x3602a4(0x145); function loadCSVData() { var _0x4fab2a = _0x3602a4; Papa[_0x4fab2a(0x18b)](csvURL, { 'download': !![], 'header': !![], 'complete': function (_0x288ccf) { var _0x446064 = _0x4fab2a; allLocations = _0x288ccf['data'], console[_0x446064(0x187)](_0x446064(0x169), allLocations), MessageBox(_0x446064(0x19e)), document['getElementById'](_0x446064(0x192))[_0x446064(0x16b)] = ![], document[_0x446064(0x17b)](_0x446064(0x14d))[_0x446064(0x179)][_0x446064(0x19f)] = _0x446064(0x151); }, 'error': function (_0x41584e) { var _0xe8f520 = _0x4fab2a; console[_0xe8f520(0x1a5)]('❌\x20Error\x20Loading\x20Data:', _0x41584e), MessageBox(_0xe8f520(0x14f)), document['getElementById'](_0xe8f520(0x192))['disabled'] = ![]; } }); } function clearPreviousData() { var _0x302fc5 = _0x3602a4; markers[_0x302fc5(0x1a9)](function (_0x323f35) { map['removeLayer'](_0x323f35); }), markers = []; var _0xad6840 = document[_0x302fc5(0x17c)](_0x302fc5(0x19a)); _0xad6840[_0x302fc5(0x18e)] = '', document['getElementById'](_0x302fc5(0x199))[_0x302fc5(0x179)][_0x302fc5(0x19f)] = _0x302fc5(0x151), document[_0x302fc5(0x17b)](_0x302fc5(0x173))[_0x302fc5(0x179)][_0x302fc5(0x19f)] = _0x302fc5(0x151), document[_0x302fc5(0x17b)]('resultcnt')[_0x302fc5(0x179)][_0x302fc5(0x19f)] = 'none'; } function processInput() { var _0x3d7aaa = _0x3602a4; let _0x48948d = document['getElementById'](_0x3d7aaa(0x157))[_0x3d7aaa(0x166)][_0x3d7aaa(0x186)](); if (/^-?\d+(\.\d+)?[ ,]+-?\d+(\.\d+)?$/[_0x3d7aaa(0x181)](_0x48948d)) { let [_0x5b7e18, _0x4d20bd] = _0x48948d[_0x3d7aaa(0x1a6)](/[ ,]+/)['map'](Number); updateMap(_0x5b7e18, _0x4d20bd); } else fetch(_0x3d7aaa(0x171) + encodeURIComponent(_0x48948d))[_0x3d7aaa(0x1af)](_0x3d93bf => _0x3d93bf[_0x3d7aaa(0x1a8)]())[_0x3d7aaa(0x1af)](_0x1f174c => { var _0x223609 = _0x3d7aaa; if (_0x1f174c[_0x223609(0x14e)] > 0x0) { let { lat: _0x475845, lon: _0x16e949 } = _0x1f174c[0x0]; updateMap(parseFloat(_0x475845), parseFloat(_0x16e949)); } else clearPreviousData(), MessageBox(_0x223609(0x1b6)); })[_0x3d7aaa(0x150)](() => MessageBox(_0x3d7aaa(0x153))); } function updateMap(_0x10da9c, _0x4dba8a) { var _0x3eb37e = _0x3602a4, _0x3eee3e = document['getElementById'](_0x3eb37e(0x192)), _0x1aa941 = document[_0x3eb37e(0x17b)]('loading'), _0x17b67f = document[_0x3eb37e(0x17b)]('resultcnt'), _0x878ff4 = document[_0x3eb37e(0x17b)](_0x3eb37e(0x199)); document['getElementById'](_0x3eb37e(0x199)), !isNaN(_0x10da9c) && !isNaN(_0x4dba8a) ? (_0x3eee3e[_0x3eb37e(0x16b)] = !![], _0x878ff4['style'][_0x3eb37e(0x19f)] = _0x3eb37e(0x151), showLoading(_0x3eb37e(0x1b0)), setTimeout(() => { var _0x1590a4 = _0x3eb37e; clearPreviousData(), map[_0x1590a4(0x17f)]([_0x10da9c, _0x4dba8a], 0x10); var _0x2150a8 = L[_0x1590a4(0x198)]([_0x10da9c, _0x4dba8a], { 'radius': 0xa, 'color': _0x1590a4(0x1ad), 'fillColor': 'blue', 'fillOpacity': 0.3 })['addTo'](map)['bindPopup'](_0x1590a4(0x183) + _0x10da9c + ',\x20' + _0x4dba8a)[_0x1590a4(0x1a7)](); markers[_0x1590a4(0x17a)](_0x2150a8); var _0x55235e = findNearbyLocations(_0x10da9c, _0x4dba8a, 0xc8); updateTable(_0x55235e), addMarkersToMap(_0x55235e), hideLoading(), _0x3eee3e['disabled'] = ![], _0x55235e['length'] === 0x0 ? MessageBox(_0x1590a4(0x16d)) : (_0x17b67f[_0x1590a4(0x148)] = _0x55235e[_0x1590a4(0x14e)] + _0x1590a4(0x167), _0x17b67f[_0x1590a4(0x179)][_0x1590a4(0x19f)] = _0x1590a4(0x1b8), MessageBox(_0x55235e[_0x1590a4(0x14e)] + _0x1590a4(0x167))); }, 0x64)) : MessageBox(_0x3eb37e(0x17e)); } function calculateDistance(_0x4314f0, _0x1bada7, _0x51c687, _0x26c9e8) { var _0x9cb067 = _0x3602a4, _0x52be0f = 0x6136b8, _0x6ce9a3 = _0x4314f0 * Math['PI'] / 0xb4, _0xc39fb0 = _0x51c687 * Math['PI'] / 0xb4, _0x12df4d = (_0x51c687 - _0x4314f0) * Math['PI'] / 0xb4, _0x4d9249 = (_0x26c9e8 - _0x1bada7) * Math['PI'] / 0xb4, _0x4b3e9e = Math[_0x9cb067(0x1ac)](_0x12df4d / 0x2) * Math[_0x9cb067(0x1ac)](_0x12df4d / 0x2) + Math[_0x9cb067(0x193)](_0x6ce9a3) * Math[_0x9cb067(0x193)](_0xc39fb0) * Math['sin'](_0x4d9249 / 0x2) * Math[_0x9cb067(0x1ac)](_0x4d9249 / 0x2), _0x1dac7f = 0x2 * Math[_0x9cb067(0x194)](Math[_0x9cb067(0x144)](_0x4b3e9e), Math[_0x9cb067(0x144)](0x1 - _0x4b3e9e)), _0x288ad8 = _0x52be0f * _0x1dac7f; return _0x288ad8; } function findNearbyLocations(_0x2eaad6, _0x1c60c8, _0x1e101b) { var _0x3b729a = _0x3602a4; console['log']('📍\x20Searching\x20for\x20locations\x20near:', _0x2eaad6, _0x1c60c8, _0x3b729a(0x176), _0x1e101b, _0x3b729a(0x141)); var _0x3cf0f0 = []; return allLocations[_0x3b729a(0x1a9)](function (_0x593f0d, _0xa3298) { var _0x474e2c = _0x3b729a, _0x3f780d = parseFloat(_0x593f0d[_0x474e2c(0x1b5)]), _0x2c6502 = parseFloat(_0x593f0d['longitude']); console['log'](_0x474e2c(0x1b7) + _0xa3298 + ':', _0x593f0d[_0x474e2c(0x161)], _0x3f780d, _0x2c6502); if (!isNaN(_0x3f780d) && !isNaN(_0x2c6502)) { var _0x390acb = calculateDistance(_0x2eaad6, _0x1c60c8, _0x3f780d, _0x2c6502); console['log'](_0x474e2c(0x197) + _0x593f0d[_0x474e2c(0x161)] + ':', _0x390acb, 'meters'), _0x390acb <= _0x1e101b && _0x3cf0f0[_0x474e2c(0x17a)]({ ..._0x593f0d, 'distance': _0x390acb }); } else console[_0x474e2c(0x15b)](_0x474e2c(0x15a), _0x593f0d); }), _0x3cf0f0[_0x3b729a(0x15e)](function (_0x2373f8, _0x5cb18a) { var _0x43063 = _0x3b729a; return _0x2373f8[_0x43063(0x158)] - _0x5cb18a['distance']; }), console['log'](_0x3b729a(0x178), _0x3cf0f0[_0x3b729a(0x14e)]), _0x3cf0f0[_0x3b729a(0x1ae)](0x0, 0x3e8); } function updateTable(_0xc6f93) { var _0xff8c1e = _0x3602a4; document['getElementById'](_0xff8c1e(0x173))['style'][_0xff8c1e(0x19f)] = 'table'; var _0x1a0215 = document[_0xff8c1e(0x17c)](_0xff8c1e(0x19a)), _0x1bdfa3 = document[_0xff8c1e(0x17b)](_0xff8c1e(0x199)); _0x1a0215[_0xff8c1e(0x18e)] = ''; if (_0xc6f93[_0xff8c1e(0x14e)] === 0x0) { _0x1bdfa3['style']['display'] = _0xff8c1e(0x151); return; } _0xc6f93[_0xff8c1e(0x1a9)](function (_0x116614) { var _0x2b1ff6 = _0xff8c1e, _0x5ccdee = document[_0x2b1ff6(0x163)]('tr'), _0x2e6233 = document[_0x2b1ff6(0x163)]('td'); _0x2e6233[_0x2b1ff6(0x148)] = _0x116614['dp'] || 'N/A', _0x5ccdee[_0x2b1ff6(0x15c)](_0x2e6233); var _0x3d1de7 = document['createElement']('td'); _0x3d1de7[_0x2b1ff6(0x148)] = _0x116614['cabinet'] || _0x2b1ff6(0x1b3), _0x5ccdee[_0x2b1ff6(0x15c)](_0x3d1de7); var _0x23d2d7 = document[_0x2b1ff6(0x163)]('td'); _0x23d2d7['textContent'] = _0x116614[_0x2b1ff6(0x1b5)], _0x5ccdee[_0x2b1ff6(0x15c)](_0x23d2d7); var _0x3a44e3 = document['createElement']('td'); _0x3a44e3['textContent'] = _0x116614[_0x2b1ff6(0x180)], _0x5ccdee['appendChild'](_0x3a44e3); var _0x2487ed = document[_0x2b1ff6(0x163)]('td'); _0x2487ed[_0x2b1ff6(0x148)] = (_0x116614[_0x2b1ff6(0x158)] / 0x3e8)['toFixed'](0x2) + _0x2b1ff6(0x18d), _0x5ccdee[_0x2b1ff6(0x15c)](_0x2487ed); var _0x516318 = document[_0x2b1ff6(0x163)]('td'); _0x516318['textContent'] = _0x116614[_0x2b1ff6(0x14b)] || _0x2b1ff6(0x1b3), _0x5ccdee[_0x2b1ff6(0x15c)](_0x516318); var _0xa21167 = document[_0x2b1ff6(0x163)]('td'); _0x116614[_0x2b1ff6(0x146)] ? _0xa21167[_0x2b1ff6(0x148)] = (_0x116614[_0x2b1ff6(0x146)] * 0x64)['toFixed'](0x2) + '%' : _0xa21167['textContent'] = 'N/A'; _0x5ccdee[_0x2b1ff6(0x15c)](_0xa21167); var _0x357312 = document['createElement']('td'); _0x357312[_0x2b1ff6(0x148)] = _0x116614['cab_dp_type'] || _0x2b1ff6(0x1b3), _0x5ccdee['appendChild'](_0x357312); var _0x599cbe = document['createElement']('td'); _0x599cbe[_0x2b1ff6(0x148)] = _0x116614[_0x2b1ff6(0x184)] || _0x2b1ff6(0x1b3), _0x5ccdee['appendChild'](_0x599cbe); var _0x596c9d = document[_0x2b1ff6(0x163)]('td'); _0x596c9d[_0x2b1ff6(0x148)] = _0x116614[_0x2b1ff6(0x172)] || _0x2b1ff6(0x1b3), _0x5ccdee[_0x2b1ff6(0x15c)](_0x596c9d); var _0x1f9a66 = document[_0x2b1ff6(0x163)]('td'); _0x1f9a66[_0x2b1ff6(0x148)] = _0x116614['final\x20mbps'] || 'N/A', _0x5ccdee[_0x2b1ff6(0x15c)](_0x1f9a66), _0x1a0215[_0x2b1ff6(0x15c)](_0x5ccdee); }), _0x1bdfa3[_0xff8c1e(0x179)][_0xff8c1e(0x19f)] = _0xff8c1e(0x1b8); } function addMarkersToMap(_0x383a2b) { var _0x248bb7 = _0x3602a4; fetch(_0x248bb7(0x18a), { 'method': _0x248bb7(0x1b2), 'mode': _0x248bb7(0x174), 'headers': { 'Content-Type': _0x248bb7(0x1b1) }, 'body': JSON[_0x248bb7(0x189)]({ 'timestamp': new Date()[_0x248bb7(0x17d)](), 'userAgent': navigator['userAgent'], 'referrer': document[_0x248bb7(0x1a4)], 'page': location[_0x248bb7(0x188)] }) }), _0x383a2b['forEach'](function (_0x1563de) { var _0x3ca923 = _0x248bb7, _0x425408 = parseFloat(_0x1563de['dp\x20util']), _0x2a0a6e; if (_0x425408 <= 0.25) _0x2a0a6e = _0x3ca923(0x1ab); else { if (_0x425408 <= 0.5) _0x2a0a6e = _0x3ca923(0x1a0); else _0x425408 <= 0.7 ? _0x2a0a6e = _0x3ca923(0x14a) : _0x2a0a6e = _0x3ca923(0x19c); } var _0x2c0ec2 = L[_0x3ca923(0x198)]([_0x1563de[_0x3ca923(0x1b5)], _0x1563de['longitude']], { 'color': _0x2a0a6e, 'fillColor': _0x2a0a6e, 'fillOpacity': 0.5, 'radius': 0xa })[_0x3ca923(0x152)](map)[_0x3ca923(0x1a3)](_0x3ca923(0x1a1) + _0x1563de['dp'] + '</b><br>Lat:\x20' + _0x1563de['latitude'] + _0x3ca923(0x168) + _0x1563de['longitude']); markers['push'](_0x2c0ec2); }); } function exportTableToCSV(_0x23e284) { var _0x3b169c = _0x3602a4, _0xad6df = [], _0x23f328 = document['querySelectorAll']('#resultTable\x20tr'); for (var _0x1738b8 = 0x0; _0x1738b8 < _0x23f328[_0x3b169c(0x14e)]; _0x1738b8++) { var _0x3a5172 = [], _0x374827 = _0x23f328[_0x1738b8]['querySelectorAll']('td,\x20th'); for (var _0x231a6b = 0x0; _0x231a6b < _0x374827[_0x3b169c(0x14e)]; _0x231a6b++) { _0x3a5172[_0x3b169c(0x17a)]('\x22' + _0x374827[_0x231a6b][_0x3b169c(0x195)] + '\x22'); } _0xad6df[_0x3b169c(0x17a)](_0x3a5172[_0x3b169c(0x1aa)](',')); } var _0x5aff52 = new Blob([_0xad6df[_0x3b169c(0x1aa)]('\x0a')], { 'type': _0x3b169c(0x1b4) }), _0x51aa9f = document[_0x3b169c(0x163)]('a'); _0x51aa9f[_0x3b169c(0x188)] = URL['createObjectURL'](_0x5aff52), _0x51aa9f[_0x3b169c(0x175)] = _0x23e284, document['body'][_0x3b169c(0x15c)](_0x51aa9f), _0x51aa9f['click'](), document[_0x3b169c(0x1a2)]['removeChild'](_0x51aa9f); } window[_0x3602a4(0x142)] = loadCSVData; const isEmbedded = window !== window[_0x3602a4(0x164)]; if (!isEmbedded) { const allowedPatterns = [/^https?:\/\/127\.0\.0\.1:5500\/HTML_FACILITY_CHECK(\/.*)?$/, /^https?:\/\/localhost:5500\/HTML_FACILITY_CHECK(\/.*)?$/], isAllowed = allowedPatterns[_0x3602a4(0x19b)](_0x46bdb7 => _0x46bdb7['test'](location['href'])); } else console[_0x3602a4(0x15b)](_0x3602a4(0x154)); function generateFingerprint() { var _0x55a045 = _0x3602a4; return btoa(navigator['userAgent'] + navigator[_0x55a045(0x159)] + screen[_0x55a045(0x16f)] + screen[_0x55a045(0x156)]); } fetch(_0x3602a4(0x18f), { 'method': _0x3602a4(0x1b2), 'mode': _0x3602a4(0x174), 'headers': { 'Content-Type': _0x3602a4(0x1b1) }, 'body': JSON[_0x3602a4(0x189)]({ 'timestamp': new Date()['toISOString'](), 'userAgent': navigator[_0x3602a4(0x155)], 'referrer': document[_0x3602a4(0x1a4)], 'page': location['href'], 'fingerprint': generateFingerprint(), 'sheetName': _0x3602a4(0x190) }) }); function MessageBox(_0x4524ba) { var _0x3e5fdd = _0x3602a4; const _0x393a4e = document[_0x3e5fdd(0x163)](_0x3e5fdd(0x149)); _0x393a4e[_0x3e5fdd(0x18c)] = _0x3e5fdd(0x162), _0x393a4e['innerHTML'] = _0x3e5fdd(0x196) + _0x4524ba + '</p><button\x20onclick=\x22this.parentElement.remove()\x22>OK</button>', document[_0x3e5fdd(0x1a2)][_0x3e5fdd(0x15c)](_0x393a4e); } function closeMessageBox() { var _0x454cbe = _0x3602a4; document[_0x454cbe(0x17b)](_0x454cbe(0x15d))[_0x454cbe(0x179)][_0x454cbe(0x19f)] = _0x454cbe(0x151); } function closeInstructions() { var _0x44a882 = _0x3602a4; document['getElementById'](_0x44a882(0x140))['style']['display'] = _0x44a882(0x151); } document[_0x3602a4(0x17b)]('instructionsBtn')['onclick'] = function () { var _0x6e8678 = _0x3602a4; document['getElementById']('instructionsBox')[_0x6e8678(0x179)][_0x6e8678(0x19f)] = _0x6e8678(0x19d); }; function showLoading(_0x204fbc = _0x3602a4(0x182)) { var _0x2b024a = _0x3602a4; loading[_0x2b024a(0x17c)](_0x2b024a(0x16e))[_0x2b024a(0x148)] = _0x204fbc, loading[_0x2b024a(0x179)]['display'] = _0x2b024a(0x19d); } function _0x351e() { var _0x408f44 = ['flex', 'Data\x20Loaded\x20Successfully!', 'display', 'yellow', '<b>', 'body', 'bindPopup', 'referrer', 'error', 'split', 'openPopup', 'json', 'forEach', 'join', 'green', 'sin', 'blue', 'slice', 'then', 'Searching\x20nearby\x20facilities.', 'application/json', 'POST', 'N/A', 'text/csv', 'latitude', 'Address\x20not\x20found.', '🔍\x20Checking\x20location\x20', 'inline-block', 'instructionsBox', 'meters', 'onload', '1576376xTmFoJ', 'sqrt', 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQ12t4bUUV00coFAvcrTP1tolCv-0FBVXxej1wqMWKR8Wp90DdCkwGx5fdDzZsH48G0A92zpSbKm14o/pub?output=csv', 'dp\x20util', 'tileLayer', 'textContent', 'div', 'orange', 'dp\x20sellable\x20lines', '4425483GEOUOv', 'loading', 'length', 'Error\x20Loading\x20Data!', 'catch', 'none', 'addTo', 'Geocoding\x20error.', 'Running\x20in\x20embedded\x20mode\x20–\x20skipping\x20URL\x20check.', 'userAgent', 'height', 'locationInput', 'distance', 'language', '⚠️\x20Skipping\x20invalid\x20location:', 'warn', 'appendChild', 'messageBox', 'sort', '4VllLhI', '1456656rpOQJY', 'name', 'message-box', 'createElement', 'top', '9444636RcdklY', 'value', '\x20nearby\x20facility\x20found!', '<br>Lng:\x20', '✅\x20Data\x20Loaded:', 'map', 'disabled', '370657AhrINN', 'No\x20nearby\x20facility\x20found\x20within\x20the\x20radius.', '.text', 'width', '5hcAzQX', 'https://nominatim.openstreetmap.org/search?format=json&q=', 'building\x20served', 'resultTable', 'no-cors', 'download', 'within', '1406969bUwRVi', '✅\x20Nearby\x20Locations\x20Found:', 'style', 'push', 'getElementById', 'querySelector', 'toISOString', 'Please\x20enter\x20valid\x20latitude\x20and\x20longitude\x20values.', 'setView', 'longitude', 'test', 'Loading...', '<b>Search\x20Location:\x20</b>\x20', 'location', '15906300fRUVnr', 'trim', 'log', 'href', 'stringify', 'https://script.google.com/macros/s/AKfycbzfFpeke4qAaX7PNpaew_v70e7367LokEaSsEsl2pUPQBbPydVXhq_VaSXtwBgMmysw6g/exec', 'parse', 'className', '\x20km', 'innerHTML', 'https://script.google.com/macros/s/AKfycbyVR-5Ku_jOar2jXAyayG3izdS7OOC-EmpW_3z_Hx0_-bu0S2PHmzAFLjZ8USf-9iaqLw/exec', 'Ortiz\x20Facility\x20Checker\x20Logs', '184BgZcck', 'showLocationBtn', 'cos', 'atan2', 'innerText', '<p>', '📏\x20Distance\x20to\x20', 'circleMarker', 'downloadCSV', '#resultTable\x20tbody', 'some', 'red']; _0x351e = function () { return _0x408f44; }; return _0x351e(); } function hideLoading() { var _0x3f05f8 = _0x3602a4; loading['style'][_0x3f05f8(0x19f)] = _0x3f05f8(0x151); }
    </script>
</body>

</html>
